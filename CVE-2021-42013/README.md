# *CVE-2021-42013*

- Apache HTTP Server 2.4.49 có lỗ hổng path traversal do xử lý không đúng các ký tự %2e (.) và %2f (/) trong URL.

- Apache vá lỗi này trong 2.4.50 (CVE-2021-41773) nhưng bản vá chưa đầy đủ, dẫn đến CVE-2021-42013 vẫn có thể bị khai thác.

- Nếu "Require all denied" không được thiết lập đúng trong cấu hình Apache, kẻ tấn công có thể truy cập tệp ngoài thư mục gốc web (DocumentRoot).

![image](https://github.com/user-attachments/assets/dd8d8127-57f3-4916-b02e-e34f84b9813f)

- Nếu mod_cgi được bật, kẻ tấn công có thể thực thi mã từ xa bằng cách truy cập các script CGI.

![image](https://github.com/user-attachments/assets/e5732bc8-d12e-4307-a6af-225a551ef2f8)

![image](https://github.com/user-attachments/assets/0360a58f-0d9e-4d69-8e23-2a85d6e0a4b2)

# Build docker

- Build docker:

    `docker build -t cve-2021-42013 .`

- Run docker:

    `docker run -it cve-2021-42013`

# Exploit

- Kiểm tra lỗ hổng path traversal:
    `./exploit.sh -u http://172.17.0.2 -p`

![image](https://github.com/user-attachments/assets/1e4349ae-952f-4476-a472-0a9172d0ebb7)

- Thông báo tồn tại lỗ hổng path traversal.

- Thêm IP attacker và cổng lắng nghe reverse shell:

 ![image](https://github.com/user-attachments/assets/6e238eac-8a45-420d-ae45-9b738b35fa9c)
 
Mở cổng 4444 để lắng nghe:

![image](https://github.com/user-attachments/assets/d771e130-c13a-43a4-94e4-804fed971180)

- Thực hiện RCE hệ thống:

  `./exploit.sh -u http://172.17.0.2 -r`

![image](https://github.com/user-attachments/assets/d7db53d7-151e-491e-b979-c53e753ceb48)

![image](https://github.com/user-attachments/assets/16399b17-269f-474c-afd7-ce4fa873b26f)

