ServerRoot "/"

#su dung cong 80
Listen 80

#nap cac module Apache
LoadModule authn_file_module modules/mod_authn_file.so      
#xac thuc nguoi dung qua file
LoadModule authn_core_module modules/mod_authn_core.so      
#xac thuc loi apache
LoadModule authz_host_module modules/mod_authz_host.so      
#kiem soat truy cap theo ip/hostname
LoadModule authz_groupfile_module modules/mod_authz_groupfile.so
LoadModule authz_user_module modules/mod_authz_user.so
LoadModule authz_core_module modules/mod_authz_core.so
LoadModule access_compat_module modules/mod_access_compat.so
LoadModule auth_basic_module modules/mod_auth_basic.so      
#xac thuc basic(username, password)
LoadModule reqtimeout_module modules/mod_reqtimeout.so
LoadModule filter_module modules/mod_filter.so
LoadModule mime_module modules/mod_mime.so
LoadModule log_config_module modules/mod_log_config.so
LoadModule env_module modules/mod_env.so
LoadModule headers_module modules/mod_headers.so        
#kiem soat http headers
LoadModule setenvif_module modules/mod_setenvif.so
LoadModule version_module modules/mod_version.so
LoadModule unixd_module modules/mod_unixd.so
LoadModule status_module modules/mod_status.so
LoadModule autoindex_module modules/mod_autoindex.so
LoadModule cgid_module modules/mod_cgid.so          
#chay script CGI
LoadModule dir_module modules/mod_dir.so
LoadModule alias_module modules/mod_alias.so        
#tao alias(dinh danh lai duong dan)


#kiem soat quyen va user chay apache tren ubuntu
<IfModule unixd_module>

User www-data
Group www-data

#de bao mat hon thi nen giu mac dinh la www-data hoac apache
</IfModule>


ServerName localhost

<Directory /> 
#cau hinh quyen truy cap thu muc goc
    AllowOverride none 
    #khong cho phep .htaccess ghi de cau hinh
    Require all granted 
    #cho phep tat ca truy cap vao thu muc hien tai => noi bat dau cua lo hong, nen de ve mac dinh Require all denied
</Directory>


DocumentRoot "/var/www/html" 
#chi dinh thu muc goc, noi chua website


<Directory "/var/www/html">  
#cau hinh quyen truy cap va hanh vi cua thu muc
    Options Indexes FollowSymLinks      
    #dieu chinh cac tuy chon trong thu muc
    #Options -> giup bat/tat cac tinh nang trong thu muc
    #Indexes-> hien thi danh sach file neu khong co file index => hacker co the xm danh sach file tren server
    #FollowSymLinks -> cho phep su dung lien ket tuong trung (symlink)
    
    AllowOverride None                  
    #khong cho phep file .htaccess ghi de cau hinh
    
    Require all granted
    #cho phep moi nguoi truy cap
</Directory>


<IfModule dir_module>
    DirectoryIndex index.html       
    #chi danh trang mac dinh khi truy cap thu muc tren web server
</IfModule>


<Files ".ht*">
    Require all denied                  
    #khong cho phep truy cap cac file .ht* nhu: .htaccess, htpasswd, htsomething....
</Files>


ErrorLog "/var/log/apache2/error.log"       
#vi tri file ghi log loi cua apache


LogLevel warn       
#xac dinh muc do chi tiet cua loi duoc ghi vao log, warn co nghia chi ghi lai cac canh bao tro len


#format, ghi nhan log truy cap
<IfModule log_config_module>
  
    LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\"" combined
    LogFormat "%h %l %u %t \"%r\" %>s %b" common

    <IfModule logio_module>
      
      LogFormat "%h %l %u %t \"%r\" %>s %b \"%{Referer}i\" \"%{User-Agent}i\" %I %O" combinedio
    </IfModule>

   
    CustomLog "logs/access_log" common
   
</IfModule>

<IfModule alias_module>
    
    Alias /icons /icons                         
    #tao duong dan ao anh xa URL den mot thu muc tren may chu
    <Directory /icons>
        Require all granted                    
         #cho phep moi nguoi truy cap 
    </Directory>
    
    ScriptAlias /cgi-bin/ "/cgi-bin/"           
    #anh xa url den thu muc chua cac script CGI(noi thuc thi cac script)

</IfModule>

<IfModule cgid_module>
   
</IfModule>


<Directory "/cgi-bin">      
#cau hinh thu muc /cgi-bin de apache co the chay cac script CGI
    AllowOverride None      
    Options +ExecCGI        
    #cho phep thuc thi file CGI trong thu muc nay
    Require all granted     
    #moi nguoi deu co the truy cap thu muc nay
</Directory>

<IfModule headers_module>   
#cho phep thao tac voi http header trong apache
    RequestHeader unset Proxy early     
    #go bo unset tieu de http Proxy truoc khi gui request dieu nay giup ngan chan cac cuoc tan cong lien quan den header Proxy hoac bypass proxy
</IfModule>

<IfModule mime_module>      
#thiet lap MIME Types
   
    TypesConfig conf/mime.types

    
    AddType application/x-compress .Z
    AddType application/x-gzip .gz .tgz

    
</IfModule>


<IfModule proxy_html_module>        
#cau hinh Proxy HTML
Include conf/extra/proxy-html.conf
</IfModule>


<IfModule ssl_module>               
#Cau hinh SSL
                                
SSLRandomSeed startup builtin       
#Tao so ngau nhien khi khoi dong Apache
SSLRandomSeed connect builtin       
#Tao so ngau nhien khi ket noi SSL
</IfModule>